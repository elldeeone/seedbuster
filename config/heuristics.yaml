# Heuristics overrides for SeedBuster (editable without code changes).

domain:
  target_patterns:
    - kaspa
    - kaspanet
    - kaspawallet
    - kasware
    - kaspapay
  suspicious_tlds:
    - xyz
    - top
    - click
    - online
    - site
    - website
    - link
    - club
    - fun
    - icu
    - buzz
    - quest
  keywords:
    - keyword: wallet
      points: 10
    - keyword: recover
      points: 15
    - keyword: seed
      points: 15
    - keyword: restore
      points: 10
    - keyword: login
      points: 5
    - keyword: secure
      points: 5
    - keyword: official
      points: 10
    - keyword: verify
      points: 10
    - keyword: claim
      points: 10
    - keyword: airdrop
      points: 10
  substitutions:
    "4": "a"
    "3": "e"
    "1": "i"
    "0": "o"
    "5": "s"
    "@": "a"
    "$": "s"

detection:
  # Flexible pattern categories - add new scam types here without code changes.
  # Each category is applied independently during content scanning.
  # Fields:
  #   name: Internal identifier (used for scam_type classification)
  #   label: Short prefix for reason messages (e.g., "SEED", "DOUBLER")
  #   threshold: Number of pattern matches required to flag as this scam type
  #   patterns: List of regex patterns with points and optional reason
  pattern_categories:
    - name: seed_phishing
      label: SEED
      threshold: 2
      patterns:
        - pattern: "recovery\\s*phrase"
          points: 10
          reason: Recovery phrase terminology
        - pattern: "seed\\s*phrase"
          points: 10
          reason: Seed phrase terminology
        - pattern: "mnemonic"
          points: 10
          reason: Mnemonic terminology
        - pattern: "secret\\s*phrase"
          points: 10
          reason: Secret phrase terminology
        - pattern: "backup\\s*phrase"
          points: 10
          reason: Backup phrase terminology
        - pattern: "12\\s*words?"
          points: 8
          reason: 12-word reference
        - pattern: "24\\s*words?"
          points: 8
          reason: 24-word reference
        - pattern: "enter\\s*(your\\s*)?seed"
          points: 15
          reason: Seed entry prompt
        - pattern: "restore\\s*wallet"
          points: 10
          reason: Wallet restore terminology
        - pattern: "import\\s*wallet"
          points: 10
          reason: Wallet import terminology
        - pattern: "recover\\s*wallet"
          points: 10
          reason: Wallet recovery terminology
        - pattern: "enter\\s*mnemonic"
          points: 15
          reason: Mnemonic entry prompt
        - pattern: "word\\s*#?\\d+"
          points: 5
          reason: Numbered word input
        - pattern: "recovery\\s*words?"
          points: 10
          reason: Recovery words terminology

    - name: crypto_doubler
      label: DOUBLER
      threshold: 3
      patterns:
        - pattern: "(send|transfer).*to\\s*(the\\s*)?(generated|pool)\\s*address"
          points: 40
          reason: Send to generated address instruction
        - pattern: "(get|receive|gain)\\s*(\\d+)?x\\s*(back|returns?|kas)?"
          points: 35
          reason: Multiplier return promise
        - pattern: "x\\s*[23]\\s*(kas|triple|returns?)"
          points: 35
          reason: 3X return promise
        - pattern: "(triple|double|multiply)\\s*(your\\s*)?(kas|crypto|funds?)"
          points: 35
          reason: Multiplier promise
        - pattern: "(join|participate)\\s*(in\\s*)?(the\\s*)?(event|airdrop|giveaway)"
          points: 25
          reason: Fake event CTA
        - pattern: "waiting\\s*confirmation"
          points: 20
          reason: Fake confirmation UI
        - pattern: "generated\\s*address"
          points: 20
          reason: Scammer wallet display
        - pattern: "(happy\\s*holiday|special\\s*event|limited\\s*time)\\s*(promotion|offer|event)?"
          points: 15
          reason: Urgency language
        - pattern: "kaspa.*ldsp.*dark.*full.*color"
          points: 30
          reason: Stolen Kaspa branding asset
        - pattern: "updateCountdown"
          points: 15
          reason: Fake countdown timer
        - pattern: "yandex.*metrica"
          points: 10
          reason: Yandex analytics (common in scam sites)

  # Legacy format (still supported for backward compatibility)
  seed_keywords:
    - "recovery\\s*phrase"
    - "seed\\s*phrase"
    - "mnemonic"
    - "secret\\s*phrase"
    - "backup\\s*phrase"
    - "12\\s*words?"
    - "24\\s*words?"
    - "enter\\s*(your\\s*)?seed"
    - "restore\\s*wallet"
    - "import\\s*wallet"
    - "recover\\s*wallet"
    - "enter\\s*mnemonic"
    - "word\\s*#?\\d+"
    - "recovery\\s*words?"
  title_keywords:
    - keyword: kaspa
      points: 10
      reason: Kaspa-related title
    - keyword: wallet
      points: 5
      reason: Wallet-related title
    - keyword: recovery
      points: 10
      reason: Recovery-related title
    - keyword: restore
      points: 10
      reason: Restore-related title
    - keyword: seed
      points: 10
      reason: Seed-related title
    - keyword: claim
      points: 5
      reason: Claim-related title
    - keyword: airdrop
      points: 5
      reason: Airdrop-related title
    - keyword: giveaway
      points: 10
      reason: Giveaway-related title (common in doubler scams)
    - keyword: event
      points: 5
      reason: Event-related title (common in doubler scams)
    - keyword: double
      points: 10
      reason: Doubler scam indicator
    - keyword: triple
      points: 10
      reason: Doubler scam indicator
    - keyword: 3x
      points: 10
      reason: Multiplier scam indicator

browser:
  exploration_targets:
    - text: legacy wallet
      priority: 1
    - text: continue on legacy
      priority: 1
    - text: recover from seed
      priority: 1
    - text: kaspa ng
      priority: 1
    - text: go to
      priority: 2
    - text: continue
      priority: 2
    - text: wallet
      priority: 1
    - text: open wallet
      priority: 1
    - text: access wallet
      priority: 1
    - text: my wallet
      priority: 1
    - text: recover
      priority: 1
    - text: restore
      priority: 1
    - text: import
      priority: 1
    - text: recovery
      priority: 1
    - text: import existing
      priority: 1
    - text: create wallet
      priority: 2
    - text: new wallet
      priority: 2
    - text: create new wallet
      priority: 2
    - text: create
      priority: 3
    # Crypto doubler / fake giveaway CTAs
    - text: join event
      priority: 1
    - text: participate
      priority: 2
    - text: claim airdrop
      priority: 1
    - text: claim now
      priority: 1
    - text: get started
      priority: 2
    - text: join airdrop
      priority: 1
    - text: join giveaway
      priority: 1
    - text: 12-word
      priority: 1
    - text: 24-word
      priority: 1
    - text: 12 word
      priority: 1
    - text: 24 word
      priority: 1
    - text: 12 words
      priority: 1
    - text: 24 words
      priority: 1
    - text: mnemonic
      priority: 1
    - text: import mnemonic
      priority: 1
    - text: enter mnemonic
      priority: 1
    - text: seed phrase
      priority: 1
    - text: secret phrase
      priority: 1
    - text: next
      priority: 2
    - text: proceed
      priority: 2
    - text: connect
      priority: 2
    - text: connect wallet
      priority: 1
    - text: settings
      priority: 3

# Infrastructure analysis thresholds
# These control when domains/certificates are considered "new" or suspicious
infrastructure:
  # TLS certificate thresholds
  tls_new_days: 30          # Certs younger than this are flagged as new
  tls_short_lived_days: 90  # Certs valid for less than this are short-lived

  # Domain age thresholds
  domain_very_new_days: 7   # Domains younger than this are very suspicious
  domain_new_days: 30       # Domains younger than this are somewhat suspicious

# Rule scoring weights
# Adjust these to tune detection sensitivity
scoring:
  # Visual fingerprint matching
  visual_match_high: 40       # Score for 80%+ visual match
  visual_match_partial: 20    # Score for 60%+ visual match
  visual_threshold_high: 80   # Threshold for high match (percent)
  visual_threshold_partial: 60  # Threshold for partial match (percent)

  # Seed form detection
  seed_form_definitive: 50    # Found via exploration with mnemonic form
  seed_form_12_24_inputs: 35  # Found 12 or 24 text inputs
  seed_form_possible: 25      # Possible seed form pattern
  seed_form_inputs: 15        # Seed-related inputs detected

  # Domain score thresholds
  domain_score_high_threshold: 50
  domain_score_high_points: 15
  domain_score_medium_threshold: 30
  domain_score_medium_points: 10

  # Infrastructure scoring
  infra_new_tls: 10           # New TLS certificate
  infra_free_short_tls: 5     # Free + short-lived cert combo
  infra_very_new_domain: 20   # Very new domain registration
  infra_new_domain: 10        # New domain registration
  infra_privacy_dns: 20       # Privacy-focused DNS (Njalla, etc.)
  infra_bulletproof: 25       # Bulletproof hosting detected

  # Code analysis scoring
  code_kit_high_confidence: 30    # Kit match >= 80% confidence
  code_kit_medium_confidence: 15  # Kit match >= 50% confidence
  code_fingerprinting_max: 20     # Max score for fingerprinting techniques
  code_antibot: 15                # Anti-bot detection code found
  code_obfuscation: 15            # Obfuscated JavaScript detected
  code_suspicious_endpoints: 10   # Suspicious C2 endpoints found
  code_suspicious_functions_max: 15  # Max score for suspicious functions

  # Network/exfiltration scoring
  exfil_known_malicious: 50       # Known malicious endpoint
  exfil_external_form: 30         # Form submits to external domain
  exfil_malicious_pattern: 15     # Malicious URL pattern matched
  exfil_malicious_domain: 40      # Known malicious domain in code
  exfil_api_key: 50               # Known malicious API key found
  exfil_scammer_signature: 30     # Scammer signature matched

  # Exploration scoring
  explore_seed_form: 40           # Seed form found via click-through
  explore_possible_seed: 30       # Possible seed form via exploration
  explore_seed_inputs: 20         # Seed inputs found via exploration
  explore_malicious_endpoint: 35  # Malicious endpoint in explored content
  explore_malicious_api_key: 30   # Malicious API key in explored content
  explore_kit_match: 25           # Kit match in explored content

  # Verdict thresholds
  verdict_high: 70
  verdict_medium: 40
  verdict_low: 20
